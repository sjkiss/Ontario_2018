WAP_models %>%
filter(Variable=="Primary_media") %>%
#Filter out the interaction model
filter(Model_Name!="Model 12") %>%
filter(str_detect(term, "Intercept", negate=T))  %>%
ggplot(., aes(x=estimate, y=fct_relevel(term, "Social_Media", "Online", "Mixed", after=10)))+
facet_wrap(~fct_relevel(Model_Name, "Model 10", "Model 11",  after=9))+
geom_pointrange(aes(xmin=estimate-(1.96*std.error), xmax=estimate+(1.96*std.error)))+geom_vline(xintercept=0, linetype=2, col="red")+labs(y="Variable", x="Coefficient")
#| echo: false
#| warning: false
#| fig-cap: OLS regression models coefficients for weighted affective polarization scores by social media usage and control variables. "Never" using social media is the reference category for self-reported social media usage.
#| fig-height: 6
#| label: fig-SU-models
WAP_models %>%
filter(Variable=="Social_Use2") %>%
filter(Model_Name!="Model 12") %>%
filter(str_detect(term, "Intercept", negate=T)) %>%
ggplot(., aes(x=estimate, y=fct_relevel(term, "Never", "Less than once a week","About once a week","Several times a week", "About once a day","Several times a day", after=7)))+facet_wrap(~fct_relevel(Model_Name, "Model 10", "Model 11",  after=9))+
geom_pointrange(aes(xmin=estimate-(1.96*std.error), xmax=estimate+(1.96*std.error)))+geom_vline(xintercept=0, linetype=2, col="red")+labs(y="Variable", x="Coefficient")
#| echo: false
#| warning: false
#| fig-cap: OLS regression models coefficients for weighted affective polarization scores by social media usage and control variables. "Never" using social media is the reference category for self-reported social media usage.
#| fig-height: 6
#| label: fig-SU-models
WAP_models %>%
filter(Variable=="Social_Use2") %>%
filter(Model_Name!="Model 12") %>%
filter(str_detect(term, "Intercept", negate=T)) %>%
ggplot(., aes(x=estimate, y=fct_relevel(term, "Never", "Several times a day","About once a day","Several times a week","About once a week", "Less than once a week", after=7)))+facet_wrap(~fct_relevel(Model_Name, "Model 10", "Model 11",  after=9))+
geom_pointrange(aes(xmin=estimate-(1.96*std.error), xmax=estimate+(1.96*std.error)))+geom_vline(xintercept=0, linetype=2, col="red")+labs(y="Variable", x="Coefficient")
?tbl_cross
on18 %>%
group_by(Social_Use3, Interest_cat) %>%
filter(!is.na(Interest_cat)) %>%
summarize(Bimodality=bimodality_coefficient(policy_polarization)) %>%
rename(Interest=Interest_cat) %>%
mutate(Bimodality=round(Bimodality,2)) %>%
gt()
#| label: tbl-social-use-interest-bimodality
#| eval: false
library(gt)
on18 %>%
group_by(Social_Use3, Interest_cat) %>%
filter(!is.na(Interest_cat)) %>%
summarize(Bimodality=bimodality_coefficient(policy_polarization)) %>%
rename(Interest=Interest_cat) %>%
mutate(Bimodality=round(Bimodality,2)) %>%
gt()
on18 %>%
group_by(Social_Use3, Interest_cat) %>%
filter(!is.na(Interest_cat))
on18 %>%
group_by(Social_Use3, Interest_cat) %>%
filter(!is.na(Interest_cat)) %>%
summarize(Bimodality=bimodality_coefficient(policy_polarization)) %>%
rename(Interest=Interest_cat) %>%
mutate(Bimodality=round(Bimodality,2)) %>%
gt()
on18 %>%
group_by(Interest_cat, Social_Use3) %>%
filter(!is.na(Interest_cat)) %>%
summarize(Bimodality=bimodality_coefficient(policy_polarization)) %>%
rename(Interest=Interest_cat) %>%
mutate(Bimodality=round(Bimodality,2)) %>%
gt()
on18 %>%
group_by(Interest_cat, Social_Use3) %>%
filter(!is.na(Interest_cat)) %>%
filter(!is.na(Social_Use3)) %>%
summarize(Bimodality=bimodality_coefficient(policy_polarization)) %>%
rename(Interest=Interest_cat) %>%
mutate(Bimodality=round(Bimodality,2)) %>%
gt()
on18 %>%
group_by(Social_Use2) %>%
summarize(Bimodality=bimodality_coefficient(policy_polarization)) %>%
filter(!is.na(Social_Use2)) %>%
#arrange(., desc(Bimodality)) %>%
gt() %>%
fmt_number(., columns=2, decimals=2)
on18 %>%
group_by(Interest_cat, Social_Use3) %>%
filter(!is.na(Interest_cat)) %>%
filter(!is.na(Social_Use3)) %>%
summarize(Bimodality=bimodality_coefficient(policy_polarization)) %>%
rename(Interest=Interest_cat) %>%
mutate(Bimodality=round(Bimodality,2)) %>%
gt()
#| echo: false
#| warning: false
#| label: fig-BC-SU
#| fig-width: 3
#| fig-height: 4
#| fig-cap: Bimodality Coefficents and policy position distributions by social media usage
gridExtra::grid.arrange(bimod_often, bimod_rarely)
on18 %>%
select(starts_with("agreement"))
on18 %>%
select(starts_with("agreement")) %>%
var_label()
on18 %>%
select(starts_with("agreement")) %>%
var_label() %>%
map(., str_extract_all("\[.+\]"))
on18 %>%
select(starts_with("agreement")) %>%
var_label() %>%
map(., str_extract_all("\\[.+\\]"))
on18 %>%
select(starts_with("agreement")) %>%
var_label() %>%
map(., str_extract_all(., "\\[.+\\]"))
on18 %>%
select(starts_with("agreement")) %>%
var_label() %>%
map(., str_extract_all(., "[.+]"))
?regex
on18 %>%
select(starts_with("agreement")) %>%
var_label() %>%
map(., str_extract_all(., "^\\[.+\\]"))
on18 %>%
select(starts_with("agreement")) %>%
var_label() %>%
map(., str_extract(., "^\\[.+\\]"))
on18 %>%
select(starts_with("agreement")) %>%
var_label()
on18 %>%
select(starts_with("agreement")) %>%
var_label() %>% class()
on18 %>%
select(starts_with("agreement")) %>%
var_label() %>%
map(., ~str_extract(., "^\\[.+\\]"))
on18 %>%
select(starts_with("agreement")) %>%
var_label() %>%
map(., ~str_extract_all(., "^\\[.+\\]"))
})
on18 %>%
mutate(across(starts_with("agreement")),
~{
var_label(.x)<-str_extract(var_label(.),"^\\[.+\\]" )
var_label(.x)<-str_remove_all(var_label(.x), "[|]")
.x
})
on18 %>%
mutate(across(starts_with("agreement"),
~{
var_label(.x)<-str_extract(var_label(.),"^\\[.+\\]" )
var_label(.x)<-str_remove_all(var_label(.x), "[|]")
.x
}))
})) %>%
}))
on18 %>%
mutate(across(starts_with("agreement"),
~{
var_label(.x)<-str_extract(var_label(.),"^\\[.+\\]" )
var_label(.x)<-str_remove_all(var_label(.x), "[|]")
.x
}))
on18 %>%
mutate(across(starts_with("agreement"),
~{
var_label(.x)<-str_extract(var_label(.),"^\\[.+\\]" )
var_label(.x)<-str_remove_all(var_label(.x), "[|]")
.x
})) %>%
select(starts_with("agreement")) %>%
var_label()
on18 %>%
mutate(across(starts_with("agreement"),
~{
var_label(.x)<-str_extract(var_label(.),"^\\[.+\\]" )
var_label(.x)<-str_remove_all(var_label(.x), "\\[|\\]")
.x
})) %>%
select(starts_with("agreement")) %>%
var_label()
on18 %>%
select(contains("primary"))
on18 %>%
select(starts_with('primarynews'))
on18 %>%
select(starts_with('primarynews')) %>%
var_label()
on18 %>%
select(starts_with('primarynews')) %>%
var_label() %>%
map(., str_replace_all(., "(\\[.+\\])( .+)", "(2) (1)"))
on18 %>%
select(starts_with('primarynews')) %>%
var_label() %>%
map(., str_replace_all(., "(\\[.+\\])( .+)", "{2}{1}"))
on18 %>%
select(starts_with('primarynews')) %>%
var_label() %>%
map(., str_replace_all(., "(\\[.+\\])( .+)", "\1 \2"))
on18 %>%
select(starts_with("agreement")) %>%
var_label()
})) ->on18
on18 %>%
mutate(across(starts_with("agreement"),
~{
var_label(.x)<-str_extract(var_label(.),"^\\[.+\\]" )
var_label(.x)<-str_remove_all(var_label(.x), "\\[|\\]")
.x
})) ->on18
on18 %>%
select(starts_with("agreement")) %>%
var_label()
on18 %>%
select(starts_with("agreement")) %>%
var_label() %>%
data.frame()
on18 %>%
select(starts_with("agreement")) %>%
var_label() %>%
data.frame() %>%
pivot_longer()
on18 %>%
select(starts_with("agreement")) %>%
var_label() %>%
data.frame() %>%
pivot_longer(cols=everything())
on18 %>%
select(starts_with("agreement")) %>%
var_label() %>%
data.frame() %>%
pivot_longer(cols=everything()) %>%
select(2)
on18 %>%
select(starts_with("agreement")) %>%
var_label() %>%
data.frame() %>%
pivot_longer(cols=everything()) %>%
select(2) %>%
kable()
on18 %>%
select(starts_with("agreement")) %>%
val_labels()
on18 %>%
select(starts_with("agreement")) %>%
var_label() %>%
data.frame() %>%
pivot_longer(cols=everything()) %>%
select(2) %>%
kable(., caption="Likert items presented to respondents to assess ideology. Scale was 1 (Strongly agree) to 5 (Strongly disagree)")
on18 %>%
select(starts_with("agreement")) %>%
var_label() %>%
data.frame() %>%
pivot_longer(cols=everything()) %>%
select("Question Text"=2) %>%
kable(., caption="Likert items presented to respondents to assess ideology. Scale was 1 (Strongly agree) to 5 (Strongly disagree)")
source("Code/1_load_on18.R")
#load libraries
library(tidyverse)
library(haven)
library(here)
library(labelled)
library(broom)
library(ggeffects)
library(modelsummary)
library(ggpubr)
#### Import Data####
on18<-read_sav(file=here("Data/Ontario ES 2018 LISPOP.sav"))
#### Run straightliner ####
source(here("Code/2_straightlining.r"))
nrow(on18)
#### Filter out non consenters ####
on18 %>%
filter(consent!=1) ->non_consenters
on18 %>%
filter(consent==1)->on18
#### Export file For dataverse ####
#### Export file For dataverse ####
# check variable labels
on18 %>%
map(., var_label)
remotes::install_github("gadenbuie/regexplain")
library(regexplain)
#load libraries
library(tidyverse)
library(haven)
library(here)
library(labelled)
library(broom)
library(ggeffects)
library(modelsummary)
library(ggpubr)
#### Import Data####
on18<-read_sav(file=here("Data/Ontario ES 2018 LISPOP.sav"))
#### Run straightliner ####
source(here("Code/2_straightlining.r"))
#load libraries
library(tidyverse)
library(haven)
library(here)
library(labelled)
library(broom)
library(ggeffects)
library(modelsummary)
library(ggpubr)
#### Import Data####
on18<-read_sav(file=here("Data/Ontario ES 2018 LISPOP.sav"))
#### Run straightliner ####
source(here("Code/2_straightlining.r"))
nrow(on18)
#### Filter out non consenters ####
on18 %>%
filter(consent!=1) ->non_consenters
on18 %>%
filter(consent==1)->on18
####
####
on18 %>%
map(., var_label)
on18$yob2
on18$yob
on18$YOB
on18$yob2
on18$YOB
with(on18, table(yob2, YOB))
cor(on18$YOB, on18$yob2, use="complete.obs")
####
names(on18)
on18 %>%
select(-yob2, postalcode, contains("irv_"), -filter_$, -regions)
on18 %>%
select(-yob2, postalcode, contains("irv_"), -`filter_$`, -regions)
on18 %>%
select(-yob2, postalcode, contains("irv_"), -`filter_$`, -regions) %>%
write_sav(., path=here("Data/opes_2018.sav"))
?write_sav
on18 %>%
slice(114) %>%
select(indivfinfeel)
on18 %>%
slice(114) %>%
select(indivfinfeel) %>%
nchar()
on18 %>%
select(-yob2, postalcode, contains("irv_"), -`filter_$`, -regions) %>%
save(on18, file=here("Data/opes18.Rdata"))
on18 %>%
select(-yob2, postalcode, contains("irv_"), -`filter_$`, -regions) %>%
save(on18, file=here("Data/opes_21018.Rdata"))
on18 %>%
select(-yob2, postalcode, contains("irv_"), -`filter_$`, -regions) %>%
save(on18, file=here("Data/opes_2018.Rdata"))
sample(LETTERS, size=255, replace=T)
lorum
install.packages("lorem")
library(lorem)
stri_rand_lipsum()
library(lorem)
?lorem
?ipsum
ipsum_words(., n=200)
ipsum_words(n=200)
ipsum_words(n=50)
ipsum_words(n=25)
1:50 %>%
map(., ipsum_words(n=20))
rerun(ipsum_words(n=20))
map(1:10, ipsum_words)
map_df(1:10, ipsum_words)
map_dfr(1:10, ipsum_words)
map(1:10, ipsum_words)
map(1:10, ipsum_words, n=20)
map(1:10, ipsum_words, n=20) %>%
unlist()
map(1:10, ipsum_words, n=20) %>%
unlist() %>%
data.frame()->out
out
names(out)
nchar(out$.)
map(1:10, ipsum_words, n=50) %>%
unlist() %>%
data.frame()->out
nchar(out$.)
write_sav(data="~/Desktop/test.sav")
write_sav(out, data="~/Desktop/test.sav")
write_sav(out, file="~/Desktop/test.sav")
write_sav(out, path="~/Desktop/test.sav")
names(out)<-"var1"
nchar(out$var1)
write_sav(out, path="~/Desktop/test.sav")
on18 %>%
select(indivfinfeel)
on18 %>%
select(indivfinfeel) %>%
write_sav(out, path="~/Desktop/test2.sav")
on18 %>%
select(indivfinfeel) %>%str()
str(out)
on18 %>%
select(indivfinfeel) %>%
write_sav(out, path="~/Desktop/test2.sav")
class(on18)
class(out)
on18 %>%
as.data.frame() %>%
select(indivfinfeel) %>%
write_sav(out, path="~/Desktop/test2.sav")
?write_sav
on18 %>%
as.data.frame() %>%
select(indivfinfeel) %>%
write_sav(out, path="~/Desktop/test2.sav", compress="zsav")
on18 %>%
select(-yob2, postalcode, contains("irv_"), -`filter_$`, -regions) %>%
# write_sav(on18, file=here("Data/opes_2018.sav"))
write_sav(., file="~/Desktop/opes.sav")
on18 %>%
select(-yob2, postalcode, contains("irv_"), -`filter_$`, -regions) %>%
# write_sav(on18, file=here("Data/opes_2018.sav"))
write_sav(., path="~/Desktop/opes.sav")
on18 %>%
select(-yob2, postalcode, contains("irv_"), -`filter_$`, -regions) %>%
# write_sav(on18, file=here("Data/opes_2018.sav"))
write_sav(., path="~/Desktop/opes.sav", compress="zsav")
on18 %>%
select(-yob2, postalcode, contains("irv_"), -`filter_$`, -regions) %>%
# write_sav(on18, file=here("Data/opes_2018.sav"))
as.data.frame() %>%
write_sav(., path="~/Desktop/opes.sav", compress="zsav")
on18 %>%
select(-yob2, postalcode, contains("irv_"), -`filter_$`, -regions) %>%
# write_sav(on18, file=here("Data/opes_2018.sav"))
as.data.frame() %>%
write_sav(., path="~/Desktop/opes.sav", compress="zsav")
on18 %>%
select(-yob2, postalcode, contains("irv_"), -`filter_$`, -regions) %>%
# write_sav(on18, file=here("Data/opes_2018.sav"))
as.data.frame() %>%
write_sav(., path="~/Desktop/opes.sav", compress="zsav")
on18 %>%
as.data.frame() %>%
select(indivfinfeel) %>%
write_sav(out, path="~/Desktop/test2.sav", compress="zsav")
on18 %>%
as.data.frame() %>%
select(indivfinfeel) %>%
write_sav(., path="~/Desktop/test2.sav", compress="zsav")
on18 %>%
select(-yob2, postalcode, contains("irv_"), -`filter_$`, -regions) %>%
# write_sav(on18, file=here("Data/opes_2018.sav"))
as.data.frame() %>%
write_sav(., path="~/Desktop/opes.sav", compress="zsav")
on18 %>%
select(-yob2, postalcode, contains("irv_"), -`filter_$`, -regions) %>%
# write_sav(on18, file=here("Data/opes_2018.sav"))
as.data.frame() %>%
select(indivfinfeel) %>%
write_sav(., path="~/Desktop/opes.sav", compress="zsav")
on18 %>%
select(-yob2, postalcode, contains("irv_"), -`filter_$`, -regions) %>%
# write_sav(on18, file=here("Data/opes_2018.sav"))
as.data.frame() %>%
select(indivfinfeel) %>% str()
on18 %>%
select(indivfinfeel) %>% str()
on18 %>%
select(indivfinfeel, immfeel) %>% str()
select(-yob2, postalcode, contains("irv_"), -`filter_$`, -regions) %>%
# write_sav(on18, file=here("Data/opes_2018.sav"))
as.data.frame() %>%
select(indivfinfeel) %>% str()
on18 %>%
# select(indivfinfeel, immfeel) %>% str()
select(-yob2, postalcode, contains("irv_"), -`filter_$`, -regions) %>%
# write_sav(on18, file=here("Data/opes_2018.sav"))
as.data.frame() %>%
select(indivfinfeel) %>% str()
on18 %>%
# select(indivfinfeel, immfeel) %>% str()
select(-yob2, postalcode, contains("irv_"), -`filter_$`, -regions) %>%
# write_sav(on18, file=here("Data/opes_2018.sav"))
as.data.frame() %>%
select(indivfinfeel) %>%
write_sav(., path="~/Desktop/opes.sav", compress="zsav")
on18 %>%
# select(indivfinfeel, immfeel) %>% str()
select(-yob2, postalcode, contains("irv_"), -`filter_$`, -regions) %>%
# write_sav(on18, file=here("Data/opes_2018.sav"))
as.data.frame() %>%
#select(indivfinfeel) %>%
write_sav(., path="~/Desktop/opes.sav", compress="zsav")
on18 %>%
# select(indivfinfeel, immfeel) %>% str()
select(-yob2, postalcode, contains("irv_"), -`filter_$`, -regions) %>%
# write_sav(on18, file=here("Data/opes_2018.sav"))
as.data.frame() %>%
#select(indivfinfeel) %>%
write_sav(., path="~/Desktop/opes.sav", compress="none")
on18 %>%
# select(indivfinfeel, immfeel) %>% str()
select(-yob2, postalcode, contains("irv_"), -`filter_$`, -regions) %>%
# write_sav(on18, file=here("Data/opes_2018.sav"))
as.data.frame() %>%
#select(indivfinfeel) %>%
write_sav(., path=here("Data/opes_2018.sav"), compress="none")
on18 %>%
# select(indivfinfeel, immfeel) %>% str()
select(-yob2, postalcode, contains("irv_"), -`filter_$`, -regions) %>%
save(., file=here("Data/opes_2018.rdata"))
