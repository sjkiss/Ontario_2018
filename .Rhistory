rename("mt_id" = "policy_polarization", "Condition" = "Primary_media") %>%
list(data = .)
# primary media legacy
policy_legacy <- on18 %>%
filter(Primary_media == "Legacy") %>%
select(policy_polarization)
bimodality_coefficient(policy_legacy, na.rm=T)
# primary media online
policy_online <- on18 %>%
filter(Primary_media == "Online") %>%
select(policy_polarization)
#primary media social media
policy_social_media <- on18 %>%
filter(Primary_media == "Social_Media") %>%
select(policy_polarization)
#primary media mixed
policy_mixed <- on18 %>%
filter(Primary_media == "Mixed") %>%
select(policy_polarization)
### Social Use
#high social use
policy_often <- on18 %>%
filter((Social_Use2 == "Several times a day" |
Social_Use2 == "About once a day" |
Social_Use2 == "Several times a week" |
Social_Use2 == "About once a week"  |
Social_Use2 == "Several times a month")) %>%
select(policy_polarization)
# low social use
policy_rarely <- on18 %>%
filter((Social_Use2 == "Several times in a year" |
Social_Use2 == "Never" | Social_Use2 == "About once a month")) %>%
select(policy_polarization)
bimodality_coefficient(policy_often, na.rm = T)
bimodality_coefficient(policy_rarely, na.rm = T)
#### Affective Polarization Wagner (2021) ####
#Extract feelings towards parties scores
# on18 %>%
#   select(starts_with("partyeval")) %>%
#   glimpse()
# so it looks like I took the step sometime of
# scaling these variables to 0 and 1, and they end in
# _out.
# on18 %>%
#   select(starts_with("partyeval")) %>%
#   summary()
#Looks like the originals run from 0 to 5
# on18 %>%
#   select(starts_with("partyeval")) %>%
#   val_labels()
# on18 %>%
#   select(starts_with("partyeval")) %>%
#   var_label()
#Party Numbers
#4 is Green
# 1 is Liberal
# 3 is NDP
# 2 is OPC
# 0 (0) is Really dislike and 5 (1) is really like.
#Extract _out and create a new dataset to calculate affective polarization scores
on18 <- on18 %>%
rename(Green_Like = partyeval_4_out,
Liberal_Like = partyeval_1_out,
NDP_Like = partyeval_3_out,
PC_Like = partyeval_2_out)
on18$partyeval_1_out
on18$Liberal_Like
on18$PC_Like
on18[, Liberal_Like]
on18[, NDP_Like]
on18[, "NDP_Like"]
on18[, PARTIES]
unweighted_like_scores <- function(parties, df){
data <- df[, parties]
data$mean_like <- ifelse(
rowSums(!is.na(data)) >= 2,
rowMeans(data, na.rm = T)
, NA
)
data$distance <- rowSums((data[, parties] - data$mean_like)^2, na.rm = T)/(rowSums(!is.na(data[, parties])))
data$spread <- modify(data$distance, sqrt)
data$spread
}
unweighted_like_scores(PARTIES, on18)
on18$Spread <- unweighted_like_scores(PARTIES, on18)
on18$Spread
unweighted_like_scores <- function(parties, df){
data <- df[, parties]
data$mean_like <- ifelse(
rowSums(!is.na(data)) >= 2,
rowMeans(data, na.rm = T)
, NA
)
data$distance <- rowSums((data[, parties] - data$mean_like)^2, na.rm = T)/(rowSums(!is.na(data[, parties])))
data$spread <- modify(data$distance, sqrt)
data$spread
}
PARTIES <- c("Green_Like", "Liberal_Like", "NDP_Like", "PC_Like")
on18$Spread <- unweighted_like_scores(PARTIES, on18)
#### LOAD SCRIPTS ####
source("Code/1_load_on18.R") #clean and load dataset
source("Code/0_functions.R") #load custom functions and packages needed for these analyses
source("Code/2_LSD_emotions.R")
PARTIES <- c("Green_Like", "Liberal_Like", "NDP_Like", "PC_Like")
on18$Spread <- unweighted_like_scores(PARTIES, on18)
#### Primary News Source ####
#Create a variable that classifies individuals based on the primary media type they use
on18 %>%
mutate(Primary_media=case_when(
(primarynews_7 == 1 | primarynews_6 == 1) & (primarynews_5 == 0 & primarynews_4 == 0 & primarynews_3 == 0 & primarynews_2 == 0 & primarynews_1 == 0) ~ "Social_Media", #For individuals who only use Social Media
(primarynews_4 == 1 | primarynews_5 == 1) & (primarynews_6 == 0 & primarynews_7 == 0 & primarynews_3 == 0 & primarynews_2 == 0 & primarynews_1 == 0) ~ "Online", #For individuals who only use online sources that are not social media
(primarynews_3 == 1 | primarynews_2 == 1 | primarynews_1 == 1) & (primarynews_5 == 0 & primarynews_4 == 0 & primarynews_6 == 0 & primarynews_7 == 0) ~ "Legacy", #For individuals who only receive news from television or newspapers
TRUE ~ "Mixed"
))->on18
table(on18$Primary_)
on18 %>%
select(unsg:nhse) %>%
glimpse()
#This prints the variable labels of each item to see what each measures
on18 %>%
select(unsg:nhse) %>%
var_label()
#this prints the value lablels to see what each value label contains
on18 %>%
select(unsg:nhse) %>%
val_labels()
#### LOAD SCRIPTS ####
source("Code/1_load_on18.R") #clean and load dataset
source("Code/0_functions.R") #load custom functions and packages needed for these analyses
#### Primary News Source ####
#Create a variable that classifies individuals based on the primary media type they use
on18 %>%
mutate(Primary_media=case_when(
(primarynews_7 == 1 | primarynews_6 == 1) & (primarynews_5 == 0 & primarynews_4 == 0 & primarynews_3 == 0 & primarynews_2 == 0 & primarynews_1 == 0) ~ "Social_Media", #For individuals who only use Social Media
(primarynews_4 == 1 | primarynews_5 == 1) & (primarynews_6 == 0 & primarynews_7 == 0 & primarynews_3 == 0 & primarynews_2 == 0 & primarynews_1 == 0) ~ "Online", #For individuals who only use online sources that are not social media
(primarynews_3 == 1 | primarynews_2 == 1 | primarynews_1 == 1) & (primarynews_5 == 0 & primarynews_4 == 0 & primarynews_6 == 0 & primarynews_7 == 0) ~ "Legacy", #For individuals who only receive news from television or newspapers
TRUE ~ "Mixed"
))->on18
table(on18$Primary_)
on18 %>%
select(unsg:nhse) %>%
glimpse()
#This prints the variable labels of each item to see what each measures
on18 %>%
select(unsg:nhse) %>%
var_label()
#this prints the value lablels to see what each value label contains
on18 %>%
select(unsg:nhse) %>%
val_labels()
on18 %>%
mutate(
across(.cols=unsg:nhse,
binaryrecode, #recode function from 0_functions
.names="{.col}_correct")
)->on18
on18 %>%
select(ends_with("_correct"))
lookfor(on18, "seats in the House of Commons")
#political knowledge variable
on18$pol_knowledge <- (on18$unsg_correct + on18$financename_correct +
on18$ggname_correct + on18$nhse_correct)/4
table(on18$pol_knowledge)
# Defensive coding for political knowledge variable
on18 %>%
ggplot(., aes(x=pol_knowledge))+geom_histogram()
on18 %>%
select(ends_with("correct")| "pol_knowledge") #%>%
#View()
on18$pol_knowledge
on18 %>%
group_by(Social_Use2) %>%
summarise(mean = mean(pol_knowledge, na.rm = T), sd = sd(pol_knowledge, na.rm = T))
stopifnot((isTRUE(all.equal(on18$pol_knowledge,
((on18$unsg_correct + on18$financename_correct +
on18$ggname_correct + on18$nhse_correct)/4))))) #Check to ensure the math is correct
#### POLARIZATION MEASURES ####
#### policy polarization ####
on18$climate_views <- (on18$climate_bin + on18$paris_bin)/2
#create a dataframe with all the policies
on18 %>%
select(starts_with("agreement_"))-> policies
#rename policies with more descriptive names
policy_names <- c("help_racial_minorities", "help_women", "more_coporate_tax", "more_personal_tax", "private_health_care",
"minimum_wage_to_high_prices", "income_inequality", "business_benefits_everyone",
"drug_benefit_u25", "free_post_secondary", "inappropriate_sex_ed")
names(policies)<-policy_names
#recombine
policies <- mutate_all(policies, \(x) as.numeric(as.character(x)))
policies <- range01(policies, na.rm = T)
on18 <- policies %>%
bind_cols(., on18)
policies %>%
bind_cols(., on18$Social_Use2)->policies_social_use
names(policies_social_use)<-c(policy_names, "Social_Use2")
#Create Policy Polarization Distribution
on18$agreement_1
#Recode policy polarization variables so that 0 represents the most left-wing position and 1 represents the most right-wing position
on18 <- on18 %>%
mutate(
lr_private_health_care = case_match(private_health_care,
0 ~ 1, 0.25 ~ 0.75, 0.5 ~ 0.5, 0.75 ~ 0.25, 1 ~ 0, NA ~ NA),
Lr_minimum_wage_to_high_prices = case_match(minimum_wage_to_high_prices,
0 ~ 1, 0.25 ~ 0.75, 0.5 ~ 0.5, 0.75 ~ 0.25, 1 ~ 0, NA ~ NA),
lr_business_benefits_everyone = case_match(business_benefits_everyone,
0 ~ 1, 0.25 ~ 0.75, 0.5 ~ 0.5, 0.75 ~ 0.25, 1 ~ 0, NA ~ NA),
lr_inappropriate_sex_ed = case_match(inappropriate_sex_ed,
0 ~ 1, 0.25 ~ 0.75, 0.5 ~ 0.5, 0.75 ~ 0.25, 1 ~ 0, NA ~ NA)
)
#Create a variable for the policy positions of all individuals
on18 <- on18 %>%
mutate(policy_polarization = (help_racial_minorities + help_women + more_coporate_tax +
more_personal_tax + income_inequality + drug_benefit_u25 + free_post_secondary +
lr_private_health_care + Lr_minimum_wage_to_high_prices + lr_business_benefits_everyone +
lr_inappropriate_sex_ed))
on18$partyvote2018
#legacy primary media - left-wing
policy_left_legacy <- on18 %>%
filter(Primary_media == "Legacy" & (partyvote2018 == 1 | partyvote2018 == 3)) %>%
select(policy_polarization)
#online primary media - left-wing
policy_left_online <- on18 %>%
filter(Primary_media == "Online" & (partyvote2018 == 1 | partyvote2018 == 3)) %>%
select(policy_polarization)
#social media primary media - left-wing
policy_left_social_media <- on18 %>%
filter(Primary_media == "Social_Media" & (partyvote2018 == 1 | partyvote2018 == 3)) %>%
select(policy_polarization)
#mixed primary media - left-wing
policy_left_mixed <- on18 %>%
filter(Primary_media == "Mixed" & (partyvote2018 == 1 | partyvote2018 == 3)) %>%
select(policy_polarization)
#legacy primary media - right-wing
policy_conservatives_legacy <- on18 %>%
filter(Primary_media == "Legacy" & partyvote2018 == 2) %>%
select(policy_polarization)
#online primary media - right-wing
policy_conservatives_online <- on18 %>%
filter(Primary_media == "Online" & partyvote2018 == 2) %>%
select(policy_polarization)
#social media primary media - right-wing
policy_conservatives_media <- on18 %>%
filter(Primary_media == "Social_Media" & partyvote2018 == 2) %>%
select(policy_polarization)
# mixed primary media - right-wing
policy_conservatives_mixed <- on18 %>%
filter(Primary_media == "Mixed" & partyvote2018 == 2) %>%
select(policy_polarization)
unique(on18$Social_Use)
# High social use - left-wing
policy_left_often <- on18 %>%
filter((Social_Use2 == "Several times a day" |
Social_Use2 == "About once a day" |
Social_Use2 == "Several times a week" |
Social_Use2 == "About once a week"  |
Social_Use2 == "Several times a month") &
(partyvote2018 == 1 | partyvote2018 == 3)) %>%
select(policy_polarization)
# low social use - left-wing
policy_left_rarely <- on18 %>%
filter((Social_Use2 == "Several times in a year" |
Social_Use2 == "Never" |
Social_Use2 == "About once a month") &
(partyvote2018 == 1 | partyvote2018 == 3)) %>%
select(policy_polarization)
on18$partyvote2018
# high social use - right-wing
policy_conservative_often <- on18 %>%
filter((Social_Use2 == "Several times a day" |
Social_Use2 == "About once a day" |
Social_Use2 == "Several times a week" |
Social_Use2 == "About once a week" |
Social_Use2 == "Several times a month") & partyvote2018 == 2) %>%
select(policy_polarization)
# low social use - right-wing
policy_conservative_social_rarely <- on18 %>%
filter((Social_Use2 == "Several times in a year" |
Social_Use2 == "Never" |
Social_Use2 == "About once a month" ) & partyvote2018 == 2) %>%
select(policy_polarization)
### Primary media
bimodalities <- on18 %>%
select(c(Primary_media, policy_polarization)) %>%
rename("mt_id" = "policy_polarization", "Condition" = "Primary_media") %>%
list(data = .)
# primary media legacy
policy_legacy <- on18 %>%
filter(Primary_media == "Legacy") %>%
select(policy_polarization)
# primary media online
policy_online <- on18 %>%
filter(Primary_media == "Online") %>%
select(policy_polarization)
#primary media social media
policy_social_media <- on18 %>%
filter(Primary_media == "Social_Media") %>%
select(policy_polarization)
#primary media mixed
policy_mixed <- on18 %>%
filter(Primary_media == "Mixed") %>%
select(policy_polarization)
#high social use
policy_often <- on18 %>%
filter((Social_Use2 == "Several times a day" |
Social_Use2 == "About once a day" |
Social_Use2 == "Several times a week" |
Social_Use2 == "About once a week"  |
Social_Use2 == "Several times a month")) %>%
select(policy_polarization)
# low social use
policy_rarely <- on18 %>%
filter((Social_Use2 == "Several times in a year" |
Social_Use2 == "Never" | Social_Use2 == "About once a month")) %>%
select(policy_polarization)
bimodality_coefficient(policy_often, na.rm = T)
bimodality_coefficient(policy_rarely, na.rm = T)
#Extract feelings towards parties scores
on18 %>%
select(starts_with("partyeval")) %>%
glimpse()
# so it looks like I took the step sometime of
# scaling these variables to 0 and 1, and they end in
# _out.
on18 %>%
select(starts_with("partyeval")) %>%
summary()
#Looks like the originals run from 0 to 5
on18 %>%
select(starts_with("partyeval")) %>%
val_labels()
on18 %>%
select(starts_with("partyeval")) %>%
var_label()
on18 %>%
select(id,starts_with("partyeval")&ends_with("out"))->affect
on18 <- on18 %>%
rename(Green_Like = partyeval_4_out,
Liberal_Like = partyeval_1_out,
NDP_Like = partyeval_3_out,
PC_Like = partyeval_2_out)
PARTIES <- c("Green_Like", "Liberal_Like", "NDP_Like", "PC_Like")
on18$Spread <- unweighted_like_scores(PARTIES, on18)
on18$Spread
affect_wt
WAP_scores$WAP
on18$Spread
options(scipen=999)
Soc_dis_scores$Soc_dis
on18$Spread
unweighted_like_scores <- function(parties, df){
data <- df[, parties]
data$mean_like <- ifelse(
rowSums(!is.na(data)) >= 2,
rowMeans(data, na.rm = T)
, NA
)
data$distance <- rowSums((data[, parties] - data$mean_like)^2, na.rm = T)/(rowSums(!is.na(data[, parties])))
data$spread <- sqrt(data$distance)
data$spread
}
unweighted_like_scores(PARTIES, on18)
test <- on18[1, PARTIES]
test
rowsum(test)
rowSums(test)
test <- rowSums(test)
test <- on18[1, PARTIES]
testmean <- mean(test)
testmean <- mean(t(test))
testmean
test
test[ , PARTIES] - testmean
test2 <- (test[ , PARTIES] - testmean)^2
test2
test3 <- sum(t(test2))
test3
test3 <- test3/4
test3
sqrt(test3)
test <- on18[10, PARTIES]
testmean <- mean(t(test))
test2 <- (test[ , PARTIES] - testmean)^2
test3 <- sum(t(test2))
test3 <- test3/4
sqrt(test3)
COVARS <- c("Primary_media", "Interest", "age3", "degree", "income3", "pol_knowledge")
library(estimatr)
Spread_primary_media <- list()
for(i in 1:length(COVARS)){
data <- on18 |> filter(straightliner == 0)
WAP_primary_media[[i]] <-  lm_robust(reformulate(COVARS[1:i],
response = "Spread"), data = data, se_type = "HC0")
}
#### Primary News Source ####
#Create a variable that classifies individuals based on the primary media type they use
on18 %>%
mutate(Primary_media=case_when(
(primarynews_7 == 1 | primarynews_6 == 1) & (primarynews_5 == 0 & primarynews_4 == 0 & primarynews_3 == 0 & primarynews_2 == 0 & primarynews_1 == 0) ~ "Social_Media", #For individuals who only use Social Media
(primarynews_4 == 1 | primarynews_5 == 1) & (primarynews_6 == 0 & primarynews_7 == 0 & primarynews_3 == 0 & primarynews_2 == 0 & primarynews_1 == 0) ~ "Online", #For individuals who only use online sources that are not social media
(primarynews_3 == 1 | primarynews_2 == 1 | primarynews_1 == 1) & (primarynews_5 == 0 & primarynews_4 == 0 & primarynews_6 == 0 & primarynews_7 == 0) ~ "Legacy", #For individuals who only receive news from television or newspapers
TRUE ~ "Mixed"
))->on18
for(i in 1:length(COVARS)){
data <- on18 |> filter(straightliner == 0)
WAP_primary_media[[i]] <-  lm_robust(reformulate(COVARS[1:i],
response = "Spread"), data = data, se_type = "HC0")
}
data <- on18 |> filter(straightliner == 0)
#source("Code/1_load_on18.R")
#install.packages("careless")
library(careless)
lookfor(on18, "feel")
on18 %>%
select(matches("partyeval_[0-9]$")) %>%
irv(.)->irv_party
on18$irv_party<-irv_party
on18 %>%
filter(irv_party==0)
on18 %>%
select(matches("leader_[0-9]$")) %>%
irv(.)->irv_leader
on18$irv_leader<-irv_leader
on18 %>%
filter(irv_party==0|irv_leader==0)
lookfor(on18, "taxes")
on18 %>%
select(matches("^agreement_[0-9]$")) %>%
irv(.)->irv_agreement
on18$irv_agreement<-irv_agreement
lookfor(on18, "spend")
on18 %>%
select(matches("^spending_[0-9]$")) %>%
irv(.)->irv_spending
on18$irv_spending<-irv_spending
on18 %>%
filter(if_any(contains("irv"), ~.==0))
on18 %>%
mutate(straightliner=case_when(
irv_party==0~ 1,
irv_agreement==0~1,
irv_spending==0~1,
irv_leader==0~1,
TRUE~0
))->on18
table(on18$straightliner)
data <- on18 |> filter(straightliner == 0)
on18
for(i in 1:length(COVARS)){
WAP_primary_media[[i]] <-  lm_robust(reformulate(COVARS[1:i],
response = "Spread"), data = on18, se_type = "HC0")
}
WAP_primary_media
Spread_primary_media <- list()
for(i in 1:length(COVARS)){
Spread_primary_media[[i]] <-  lm_robust(reformulate(COVARS[1:i],
response = "Spread"), data = on18, se_type = "HC0")
}
modelsummary(Spread_primary_media, stars = T)
COVARS <- c("Social_Use2", "Interest", "age3", "degree", "income3", "pol_knowledge")
on18$Pr
Spread_primary_media <- list()
for(i in 1:length(COVARS)){
Spread_primary_media[[i]] <-  lm_robust(reformulate(COVARS[1:i],
response = "Spread"), data = on18, se_type = "HC0")
}
modelsummary(Spread_primary_media, stars = T)
modelsummary(Spread_primary_media, stars = T)
COVARS <- c("Primary_media", "Interest", "age3", "degree", "income3", "pol_knowledge")
on18$Pr
Spread_primary_media <- list()
for(i in 1:length(COVARS)){
Spread_primary_media[[i]] <-  lm_robust(reformulate(COVARS[1:i],
response = "Spread"), data = on18, se_type = "HC0")
}
modelsummary(Spread_primary_media, stars = T)
on18 <- on18 %>%
mutate(Spread_sd = scale(Spread))
Spread_primary_media <- list()
for(i in 1:length(COVARS)){
Spread_primary_media[[i]] <-  lm_robust(reformulate(COVARS[1:i],
response = "Spread_sd"), data = on18, se_type = "HC0")
}
modelsummary(Spread_primary_media, stars = T)
#| label: setup
#| echo: false
library(knitr)
opts_knit$set(root.dir=rprojroot::find_rstudio_root_file())
#opts_chunk$set(warning=F,message=F)
#### LOAD SCRIPTS ####
source("Code/1_load_on18.R") #clean and load dataset
#### Run straightliner ####
source("Code/2_straightlining.r")
WAP_regdf <- map(WAP_reg, tidy, conf.int = TRUE)
WAP_regdf
straightliner <- on18 %>%
filter(straightliner == 0)
straightliners <- on18 %>%
filter(straightliner == 0)
#| label: setup
#| echo: false
library(knitr)
opts_knit$set(root.dir=rprojroot::find_rstudio_root_file())
#opts_chunk$set(warning=F,message=F)
#| label: import
#| echo: false
#| warning: false
#| message: false
#| results: 'hide'
#| output: false
library(here)
source(here("Code/3_polarization.R"))
#Cache needs to be turned off the render
